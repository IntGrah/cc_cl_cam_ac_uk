(this["webpackJsonpcompiler-explorer"]=this["webpackJsonpcompiler-explorer"]||[]).push([[0],{20:function(e,n,t){},49:function(e,n,t){},67:function(e,n,t){},68:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t.n(r),a=t(28),i=t.n(a),s=(t(49),t(3)),c=t(72),u=t(24),l={keywords:["true","false","ref","inl","inr","fst","snd","case","of","if","then","else","let","fun","in","begin","end","while","do","()"],typeKeywords:["int","bool","unit","banter"],operators:[",",":",";","+","-","*","/","~","=",":=","<","&&","||","|","->","?","!","()"],symbols:/[=><!~?:&|+\-*/^%]+/,escapes:/\\/,tokenizer:{root:[[/[a-z_$][\w$]*/,{cases:{"@typeKeywords":"keyword","@keywords":"keyword","@default":"identifier"}}],[/[A-Z][\w$]*/,"type.identifier"],{include:"@whitespace"},[/[{}()[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/\d*\.\d+([eE][-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F]+/,"number.hex"],[/\d+/,"number"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/'[^\\']'/,"string"],[/(')(@escapes)(')/,["string","string.escape","string"]],[/'/,"string.invalid"]],comment:[[/[^(*]+/,"comment"],[/\(\*/,"comment","@push"],["\\*\\)","comment","@pop"],[/[(*]/,"comment"]],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\(\*/,"comment","@comment"]]}},d={fib:"let fib( m : int) : int =\n    if m = 0\n    then 1\n    else if m = 1\n        then 1\n        else fib (m - 1) + fib (m -2)\n        end\n    end\nin\n    fib(1)\nend",fun:"(* the reason we need closures on the heap ... *) \n\nlet f(y : int) : int -> int =\n  let g(x :int) : int = y + x in g end\nin\n  let add21 : int -> int  = f(21) in\n      let add17 : int -> int  = f(17) in\n         add17(3) + add21(60)\n       end\n  end\nend",gcd:"let gcd(p : int * int) : int =\n    let m : int = fst p in\n       let  n : int = snd p in\n          if m = n\n          then m\n          else if m < n\n               then gcd(m, n - m)\n               else gcd(m - n, n)\n               end\n           end\n       end\n     end\nin\n   let x : int = 10 in\n      let  y : int = 2 in gcd(x, y) end\n    end\nend"},j=t(5),p=t(1),b=function(e){var n=Object(r.useState)({})[1],t=e.decorations,o=Object(r.useRef)(),a=Object(r.useRef)(),i=Object(r.useRef)(e.onMouseMove);i.current=e.onMouseMove;var s=Object(r.useRef)(e.onMouseLeave);s.current=e.onMouseLeave;var c=Object(r.useRef)(e.onKeyDown);return Object(r.useEffect)((function(){c.current=e.onKeyDown}),[e.onKeyDown]),Object(r.useEffect)((function(){t&&o.current&&a.current&&n((function(e){var n;return null===(n=o.current)||void 0===n?void 0:n.deltaDecorations(e,t(o.current,a.current))}))}),[t,n]),Object(p.jsx)(u.a,Object(j.a)(Object(j.a)({},e),{},{onMount:function(r,u){r.onMouseMove((function(e){i.current&&i.current(e)})),r.onMouseLeave((function(e){s.current&&s.current(e)})),e.onMount&&e.onMount(r,u),function(e,r){o.current=e,a.current=r,t&&n((function(e){var n;return null===(n=o.current)||void 0===n?void 0:n.deltaDecorations(e,t(o.current,a.current))}))}(r,u),r.onKeyDown((function(e){var n=e.browserEvent;c.current&&c.current(n)}))}}))},h=t(73);t(20);function v(e,n,t){return function(r){switch(r){case"ArrowRight":n(((e+1)%t+t)%t);break;case"ArrowLeft":n(((e-1)%t+t)%t)}}}var f=function(e){var n=e.values,t=e.index,o=e.setIndex,a=n.length,i=v(t,o,a);return function(e,n){var t=Object(r.useRef)((function(){}));Object(r.useEffect)((function(){t.current=function(t){e.includes(t.key)&&(null===n||void 0===n||n(t))}}),[e,n]),Object(r.useEffect)((function(){var e=function(e){t.current(e)};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[])}(["ArrowRight","ArrowLeft"],(function(e){return i(e.key)})),Object(p.jsxs)("div",{className:"progress",children:[Object(p.jsx)("button",{onClick:function(){return o(((t-1)%a+a)%a)},children:"<"}),Object(p.jsx)(h.a,{selectedIndex:t,values:n,appearance:"inverted",onSelect:function(e){var n=e.index;return o?o(n):null}}),Object(p.jsx)("button",{onClick:function(){return o(((t+1)%a+a)%a)},children:">"})]})},g=t(10);function O(e){return{steps:JSON.parse(e.steps).reverse(),next:function(){return O(e.next())}}}var m=function(e){return O(slang.i2Stream(e))},x=function(e){var n=slang.i3Stream(e),t=n.code,r=n.stepStream;return{code:JSON.parse(t),stepStream:O(r)}},w=function(e){var n=slang.jargonStream(e),t=n.code,r=n.stepStream;return{code:JSON.parse(t),stepStream:O(r)}};function y(e){return e.map((function(e){var n=Object(s.a)(e,2);n[0];return n[1]})).join("\n")}var k=function(e){var n,t=e.source,o=e.onMouseMove,a=e.onMouseLeave,i=e.decorations,c=Object(r.useState)(m(t)),u=Object(s.a)(c,2),l=u[0],d=l.steps,j=l.next,h=u[1],g=Object(r.useState)(0),O=Object(s.a)(g,2),x=O[0],w=O[1],y=Object(s.a)(d[x],3),k=y[0],M=y[1],S=y[2],L=Object(r.useState)(!0),N=Object(s.a)(L,2),D=N[0],E=N[1],R=D?k:k.filter((function(e){var n=Object(s.a)(e,2);n[0];return!n[1].startsWith("\t")})),C=R.map((function(e){var n=Object(s.a)(e,2);n[0];return n[1]})).join("\n").slice(1,-1),H=(D?M:(n=M,n.map((function(e,n){return e.length>40?e.split("\n").join(" ").slice(0,40)+"...":e})))).join("\n"),I=S.join("\n"),K=d.some((function(e){var n=Object(s.a)(e,3);n[0],n[1];return n[2].length>0})),W=v(x,w,d.length);return Object(r.useEffect)((function(){h(m(t))}),[t]),Object(r.useEffect)((function(){x>=d.length-3&&d[d.length-1][0].length>0&&h(j())}),[x,d,j]),Object(p.jsxs)("div",{className:"interpreter",children:[Object(p.jsxs)("div",{className:"interpreterTitle",children:[Object(p.jsxs)("h3",{children:["Step ",x," - ",x>0?d[x-1][0][0]:"Start"]}),Object(p.jsxs)("button",{onClick:function(){return E(!D)},children:[D?"Hide":"Show"," nested instructions"]})]}),Object(p.jsxs)("div",{className:"interpreterEditors",children:[Object(p.jsx)(b,{value:C,decorations:i(R),onMouseMove:o(R),onMouseLeave:a,language:"javascript",onKeyDown:function(e){return W(e.key)},options:{readOnly:!0,theme:"vs-dark",lineNumbers:function(e){return C.split("\n").length-e+1}}}),Object(p.jsx)(b,{value:H,className:"i2StackEditor",language:"javascript",onKeyDown:function(e){return W(e.key)},options:{readOnly:!0,theme:"vs-dark",lineNumbers:function(e){return H.split("\n").length-e+1}}}),K?Object(p.jsx)(b,{value:I,language:"javascript",onKeyDown:function(e){return W(e.key)},options:{readOnly:!0,theme:"vs-dark",lineNumbers:function(e){return(e-1).toString()}}}):null]}),Object(p.jsx)(f,{values:d,index:x,setIndex:w})]})},M=function(e){var n=e.source,t=e.onMouseMove,o=e.onMouseLeave,a=e.decorations,i=Object(r.useState)(x(n)),c=Object(s.a)(i,2),u=c[0],l=u.code,d=u.stepStream,j=d.steps,h=d.next,O=c[1],m=Object(r.useState)(0),w=Object(s.a)(m,2),y=w[0],k=w[1],M=Object(s.a)(j[y],3),S=M[0],L=M[1],N=M[2],D=l.map((function(e){var n=Object(s.a)(e,2);n[0];return n[1]})).join("\n"),E=L.join("\n"),R=N.join("\n"),C=j.some((function(e){var n=Object(s.a)(e,3);n[0],n[1];return n[2].length>0})),H=v(y,k,j.length);Object(r.useEffect)((function(){O(x(n))}),[n]),Object(r.useEffect)((function(){y===j.length-1&&"HALT"!==D.split("\n")[S]&&O({code:l,stepStream:h()})}),[y,l,h,S,D,j.length]);return Object(p.jsxs)("div",{className:"interpreter",children:[Object(p.jsx)("div",{className:"interpreterTitle",children:Object(p.jsxs)("h3",{children:["Step ",y," - "]})}),Object(p.jsxs)("div",{className:"interpreterEditors",children:[Object(p.jsx)(b,{value:D,language:"javascript",onKeyDown:function(e){return H(e.key)},decorations:function(e,n){return e.revealRange(new n.Range(S,1,S,1)),[{range:new n.Range(S+1,1,S+1,1),options:{isWholeLine:!0,linesDecorationsClassName:"currentLineDec"}}].concat(Object(g.a)(a(l)(e,n)))},onMouseMove:t(l),onMouseLeave:o,options:{readOnly:!0,lineNumbers:function(e){return(e-1).toString()},theme:"vs-dark"}}),Object(p.jsx)(b,{value:E,language:"javascript",onKeyDown:function(e){return H(e.key)},options:{readOnly:!0,lineNumbers:function(e){return E.split("\n").length-e+1},minimap:{enabled:!1}}}),C?Object(p.jsx)(b,{value:R,language:"javascript",onKeyDown:function(e){return H(e.key)},options:{readOnly:!0,lineNumbers:function(e){return(e-1).toString()},theme:"vs-dark",minimap:{enabled:!1}}}):null]}),Object(p.jsx)(f,{values:j,index:y,setIndex:k})]})},S=t(40),L=t.n(S),N=t(29),D=t.n(N),E=t(41),R=t.n(E),C=t(42);D.a.use(R.a);function H(e){var n;switch(e){case"H_INT":n={shape:"square","background-color":"white"};break;case"H_BOOL":n={shape:"barrel","background-color":"purple"};break;case"H_CI":n={shape:"tag","background-color":"red"};break;case"H_HI":n={shape:"round-tag","background-color":"white"};break;case"H_HEADER":n={"background-color":"black"}}return n=Object(j.a)(Object(j.a)({},n),{},{"text-margin-y":"-10","text-justification":"left","text-wrap":"wrap",color:"green"})}var I=function(e){var n=e.source,t=e.onMouseMove,o=e.onMouseLeave,a=e.decorations,i=Object(r.useState)(w(n)),c=Object(s.a)(i,2),u=c[0],l=u.code,d=u.stepStream,j=d.steps,h=d.next,O=c[1],m=l.map((function(e){var n=Object(s.a)(e,2);n[0];return n[1]})).join("\n"),x=Object(r.useState)(0),y=Object(s.a)(x,2),k=y[0],M=y[1],S=j[k],N=S.stack,D=S.cp,E=S.fp,R=S.heap,I=S.heap_graph,K=N.slice().reverse().map((function(e){return e.slice(6)})).join("\n"),W=D+1,A=N.length-E,J=R.join("\n"),_=j.some((function(e){return e.heap.length>0})),T=v(k,M,j.length);Object(r.useEffect)((function(){O(w(n))}),[n]),Object(r.useEffect)((function(){k===j.length-1&&"HALT"!==l[D][1].trim()&&O({code:l,stepStream:h()})}),[l,D,h,k,j.length]);var B=Object(r.useState)({heap:{show:!1,val:0},code:{showHeap:!1,heap:0}}),P=Object(s.a)(B,2),V=P[0],$=P[1],q=Object(s.a)(I,2),z=q[0],F=q[1],X=[].concat(Object(g.a)(z.map((function(e){return{data:e,style:H(e.tp[0])}}))),Object(g.a)(F.map((function(e){return{data:e}})))),Z=Object(C.a)((function(e){var n=e.target._private.data,t="H_CI"===n.tp[0],r={heap:{val:parseInt(n.id)+1,show:!0},code:{showHeap:t,heap:t?n.pointer+1:V.code.heap}};$(r)}),50),G=Object(C.a)((function(e){$({heap:{val:V.heap.val,show:!1},code:{showHeap:!1,heap:V.code.heap}})}),50);return Object(p.jsxs)("div",{className:"interpreter",children:[Object(p.jsx)("div",{className:"interpreterTitle",children:Object(p.jsxs)("h3",{children:["Step ",k," - "]})}),Object(p.jsxs)("div",{className:"interpreterEditors",children:[Object(p.jsx)(b,{value:m,width:"36%",language:"javascript",onKeyDown:function(e){return T(e.key)},decorations:function(e,n){return e.revealRange(new n.Range(W,1,W,1)),e.setPosition({column:0,lineNumber:W}),[{range:new n.Range(W,1,W,1),options:{isWholeLine:!0,linesDecorationsClassName:"currentLineDec"}},{range:new n.Range(V.code.heap,1,V.code.heap,1),options:{isWholeLine:!0,linesDecorationsClassName:V.code.showHeap?"heapPointerDec":""}}].concat(Object(g.a)(a(l)(e,n)))},onMouseMove:t(l),onMouseLeave:o,options:{readOnly:!0,lineNumbers:function(e){return(e-1).toString()},theme:"vs-dark",minimap:{enabled:!1},scrollBeyondLastLine:!1}}),Object(p.jsx)(b,{value:K,width:"20%",language:"javascript",onKeyDown:function(e){return T(e.key)},decorations:function(e,n){return[{range:new n.Range(A,1,A,1),options:{isWholeLine:!0,linesDecorationsClassName:"framePointerDec"}}]},options:{readOnly:!0,lineNumbers:function(e){return(K.split("\n").length-e+1).toString()},minimap:{enabled:!1},scrollBeyondLastLine:!1}}),Object(p.jsxs)("div",{className:"jargonMem",children:[_?Object(p.jsx)(b,{value:J,height:"50%",decorations:function(e,n){return V.heap.show&&e.revealRange(new n.Range(V.heap.val,1,V.heap.val,1)),[{range:new n.Range(V.heap.val,1,V.heap.val,1),options:{isWholeLine:!0,linesDecorationsClassName:V.heap.show?"heapPointerDec":""}}]},language:"javascript",onKeyDown:function(e){return T(e.key)},options:{readOnly:!0,lineNumbers:function(e){return(e-1).toString()},theme:"vs-dark",minimap:{enabled:!1},scrollBeyondLastLine:!1}}):null,Object(p.jsx)(L.a,{id:"heap",elements:X,style:{height:"50%"},cy:function(e){return e.on("add","node",(function(n){e.layout({name:"klay",klay:{direction:"DOWN",borderSpacing:80,spacing:80}}).run(),e.fit(),e.on("mouseover","node",Z),e.on("mouseout","node",G)}))}})]})]}),Object(p.jsx)(f,{values:j,index:k,setIndex:M})]})},K=(t(67),d.fib),W={allViews:["All",function(e){var n,t=e.source,r=e.decorations,o=e.onMouseMove,a=e.onMouseLeave,i=(n=t,JSON.parse(slang.interp2Code(n))),s=y(i).slice(1,-1),c=function(e){return JSON.parse(slang.interp3Code(e))}(t),u=y(c),l=function(e){return JSON.parse(slang.jargonCode(e))}(t),d=y(l);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"editorWrapper",children:[Object(p.jsx)("h4",{children:"Interpreter 2"}),Object(p.jsx)(b,{defaultLanguage:"javascript",height:"86vh",value:s,onMouseMove:o(i),onMouseLeave:a,decorations:r(i),options:{tabSize:2,readOnly:!0,theme:"vs-dark",minimap:{enabled:!1}}})]}),Object(p.jsxs)("div",{className:"editorWrapper",children:[Object(p.jsx)("h4",{children:"Interpreter 3"}),Object(p.jsx)(b,{defaultLanguage:"javascript",value:u,onMouseMove:o(c),onMouseLeave:a,decorations:r(c),height:"86vh",options:{readOnly:!0,theme:"vs-dark",minimap:{enabled:!1}}})]}),Object(p.jsxs)("div",{className:"editorWrapper",children:[Object(p.jsx)("h4",{children:"Jargon"}),Object(p.jsx)(b,{defaultLanguage:"javascript",value:d,onMouseMove:o(l),onMouseLeave:a,decorations:r(l),height:"86vh",options:{readOnly:!0,theme:"vs-dark",minimap:{enabled:!1}}})]})]})}],interp2:["Interpreter 2",k],interp3:["Interpreter 3",M],jargon:["Jargon",I]};var A=function(){var e=Object(r.useState)(K),n=Object(s.a)(e,2),t=n[0],o=n[1],a=Object(c.a)(t,1e3),i=Object(s.a)(a,1)[0],d=Object(r.useState)("allViews"),j=Object(s.a)(d,2),h=j[0],v=j[1],f=W[h][1],O=Object(r.useState)({highlight:!1,line:0}),m=Object(s.a)(O,2),x=m[0],w=m[1],y=Object(c.a)(x,50),k=Object(s.a)(y,1)[0],M=Object(u.b)();Object(r.useEffect)((function(){null===M||void 0===M||M.editor.setTheme("vs-dark"),null===M||void 0===M||M.languages.register({id:"Slang"}),null===M||void 0===M||M.languages.setMonarchTokensProvider("Slang",l)}),[M]);var S=function(){return w({highlight:!1,line:0})};return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsxs)("div",{className:"editorWrapper",children:[Object(p.jsx)("h4",{children:"Source"}),Object(p.jsx)(b,{height:"86vh",defaultValue:i,defaultLanguage:"Slang",onMouseMove:function(e){var n,t,r=null===e||void 0===e||null===(n=e.target)||void 0===n||null===(t=n.position)||void 0===t?void 0:t.lineNumber;null!==r&&void 0!==r&&w({line:r,highlight:!0})},onMouseLeave:S,decorations:function(e,n){return k.highlight?[{range:new n.Range(k.line,1,k.line,1),options:{isWholeLine:!0,linesDecorationsClassName:"sourceLineDec"}}]:[]},onChange:function(e,n){return o(void 0===e?"":e)},options:{theme:"vs-dark",minimap:{enabled:!1},scrollBeyondLastLine:!1}}),Object(p.jsx)("div",{className:"resultBox",children:Object(p.jsxs)("select",{value:h,onChange:function(e){return v(e.target.value)},children:[Object(p.jsx)("option",{value:"allViews",children:W.allViews[0]}),Object(p.jsx)("option",{value:"interp2",children:W.interp2[0]}),Object(p.jsx)("option",{value:"interp3",children:W.interp3[0]}),Object(p.jsx)("option",{value:"jargon",children:W.jargon[0]})]})})]}),Object(p.jsx)(f,{source:i,onMouseMove:function(e){return function(n){var t,r,o=null===n||void 0===n||null===(t=n.target)||void 0===t||null===(r=t.position)||void 0===r?void 0:r.lineNumber;null!==o&&void 0!==o&&w({line:e[o-1][0],highlight:!0})}},onMouseLeave:S,decorations:function(e){return function(n,t){return k.highlight?(r=e,o=k.line,r.reduce((function(e,n,t){return n[0]===o?[t].concat(Object(g.a)(e)):e}),[])).map((function(e){return{range:new t.Range(e+1,1,e+1,1),options:{isWholeLine:!0,linesDecorationsClassName:"sourceLineDec"}}})):[];var r,o}}})]})};i.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(A,{})}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.96f517e1.chunk.js.map