(this["webpackJsonpcompiler-explorer"]=this["webpackJsonpcompiler-explorer"]||[]).push([[0],{22:function(e,n,t){},55:function(e,n,t){},83:function(e,n,t){},84:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t.n(r),i=t(32),a=t.n(i),c=(t(55),t(3)),s=t(88),u=t(26),l=t(27),d={keywords:["true","false","ref","inl","inr","fst","snd","case","of","if","then","else","let","fun","in","begin","end","while","do","()"],typeKeywords:["int","bool","unit","banter"],operators:[",",":",";","+","-","*","/","~","=",":=","<","&&","||","|","->","?","!","()"],symbols:/[=><!~?:&|+\-*/^%]+/,escapes:/\\/,tokenizer:{root:[[/[a-z_$][\w$]*/,{cases:{"@typeKeywords":"keyword","@keywords":"keyword","@default":"identifier"}}],[/[A-Z][\w$]*/,"type.identifier"],{include:"@whitespace"},[/[{}()[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/\d*\.\d+([eE][-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F]+/,"number.hex"],[/\d+/,"number"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/'[^\\']'/,"string"],[/(')(@escapes)(')/,["string","string.escape","string"]],[/'/,"string.invalid"]],comment:[[/[^(*]+/,"comment"],[/\(\*/,"comment","@push"],["\\*\\)","comment","@pop"],[/[(*]/,"comment"]],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\(\*/,"comment","@comment"]]}},j={fib:"let fib( m : int) : int =\n    if m = 0\n    then 1\n    else if m = 1\n        then 1\n        else fib (m - 1) + fib (m -2)\n        end\n    end\nin\n    fib(1)\nend\n\n(* Edit me to get started *)",fun:"(* the reason we need closures on the heap ... *) \n\nlet f(y : int) : int -> int =\n  let g(x :int) : int = y + x in g end\nin\n  let add21 : int -> int  = f(21) in\n      let add17 : int -> int  = f(17) in\n         add17(3) + add21(60)\n       end\n  end\nend",gcd:"let gcd(p : int * int) : int =\n    let m : int = fst p in\n       let  n : int = snd p in\n          if m = n\n          then m\n          else if m < n\n               then gcd(m, n - m)\n               else gcd(m - n, n)\n               end\n           end\n       end\n     end\nin\n   let x : int = 10 in\n      let  y : int = 2 in gcd(x, y) end\n    end\nend"},p=t(5),h=t(1),b=function(e){var n=Object(r.useState)({})[1],t=e.decorations,o=Object(r.useRef)(),i=Object(r.useRef)(),a=Object(r.useRef)(e.onMouseMove);a.current=e.onMouseMove;var c=Object(r.useRef)(e.onMouseLeave);c.current=e.onMouseLeave;var s=Object(r.useRef)(e.onKeyDown);return Object(r.useEffect)((function(){s.current=e.onKeyDown}),[e.onKeyDown]),Object(r.useEffect)((function(){t&&o.current&&i.current&&n((function(e){var n;return null===(n=o.current)||void 0===n?void 0:n.deltaDecorations(e,t(o.current,i.current))}))}),[t,n]),Object(h.jsx)(u.a,Object(p.a)(Object(p.a)({},e),{},{onMount:function(r,u){r.onMouseMove((function(e){a.current&&a.current(e)})),r.onMouseLeave((function(e){c.current&&c.current(e)})),e.onMount&&e.onMount(r,u),function(e,r){o.current=e,i.current=r,t&&n((function(e){var n;return null===(n=o.current)||void 0===n?void 0:n.deltaDecorations(e,t(o.current,i.current))}))}(r,u),r.onKeyDown((function(e){var n=e.browserEvent;s.current&&s.current(n)}))}}))},v=t(89);t(22);function f(e,n,t){return function(r){switch(r){case"ArrowRight":n(((e+1)%t+t)%t);break;case"ArrowLeft":n(((e-1)%t+t)%t)}}}var g=function(e){var n=e.values,t=e.index,o=e.setIndex,i=n.length,a=f(t,o,i);return function(e,n){var t=Object(r.useRef)((function(){}));Object(r.useEffect)((function(){t.current=function(t){e.includes(t.key)&&(null===n||void 0===n||n(t))}}),[e,n]),Object(r.useEffect)((function(){var e=function(e){t.current(e)};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[])}(["ArrowRight","ArrowLeft"],(function(e){return a(e.key)})),Object(h.jsxs)("div",{className:"progress",children:[Object(h.jsx)("button",{onClick:function(){return o(((t-1)%i+i)%i)},children:"<"}),Object(h.jsx)(v.a,{selectedIndex:t,values:n,appearance:"inverted",onSelect:function(e){var n=e.index;return o?o(n):null}}),Object(h.jsx)("button",{onClick:function(){return o(((t+1)%i+i)%i)},children:">"})]})},O=t(10);function m(e){return{steps:JSON.parse(e.steps).reverse(),next:function(){return m(e.next())}}}var x=function(e){return m(slang.i2Stream(e))},y=function(e){var n=slang.i3Stream(e),t=n.code,r=n.stepStream;return{code:JSON.parse(t),stepStream:m(r)}},w=function(e){var n=slang.jargonStream(e),t=n.code,r=n.stepStream;return{code:JSON.parse(t),stepStream:m(r)}};function k(e){return e.map((function(e){var n=Object(c.a)(e,2);n[0];return n[1]})).join("\n")}var M=function(e){var n,t=e.source,o=e.onMouseMove,i=e.onMouseLeave,a=e.decorations,s=Object(r.useState)(x(t)),u=Object(c.a)(s,2),l=u[0],d=l.steps,j=l.next,p=u[1],v=Object(r.useState)(0),O=Object(c.a)(v,2),m=O[0],y=O[1],w=Object(c.a)(d[m],3),k=w[0],M=w[1],S=w[2],L=Object(r.useState)(!0),N=Object(c.a)(L,2),D=N[0],E=N[1],C=D?k:k.filter((function(e){var n=Object(c.a)(e,2);n[0];return!n[1].startsWith("\t")})),R=C.map((function(e){var n=Object(c.a)(e,2);n[0];return n[1]})).join("\n").slice(1,-1),I=(D?M:(n=M,n.map((function(e,n){return e.length>40?e.split("\n").join(" ").slice(0,40)+"...":e})))).join("\n"),H=S.join("\n"),K=d.some((function(e){var n=Object(c.a)(e,3);n[0],n[1];return n[2].length>0})),W=f(m,y,d.length);return Object(r.useEffect)((function(){p(x(t)),y(0)}),[t]),Object(r.useEffect)((function(){m>=d.length-3&&d[d.length-1][0].length>0&&p(j())}),[m,d,j]),Object(h.jsxs)("div",{className:"interpreter",children:[Object(h.jsxs)("div",{className:"interpreterTitle",children:[Object(h.jsxs)("h3",{children:["Step ",m," - ",m>0?d[m-1][0][0]:"Start"]}),Object(h.jsxs)("button",{onClick:function(){return E(!D)},children:[D?"Hide":"Show"," nested instructions"]})]}),Object(h.jsxs)("div",{className:"interpreterEditors",children:[Object(h.jsx)(b,{value:R,decorations:a(C),onMouseMove:o(C),onMouseLeave:i,language:"javascript",onKeyDown:function(e){return W(e.key)},options:{readOnly:!0,theme:"vs-dark",lineNumbers:function(e){return R.split("\n").length-e+1}}}),Object(h.jsx)(b,{value:I,className:"i2StackEditor",language:"javascript",onKeyDown:function(e){return W(e.key)},options:{readOnly:!0,theme:"vs-dark",lineNumbers:function(e){return I.split("\n").length-e+1}}}),K?Object(h.jsx)(b,{value:H,language:"javascript",onKeyDown:function(e){return W(e.key)},options:{readOnly:!0,theme:"vs-dark",lineNumbers:function(e){return(e-1).toString()}}}):null]}),Object(h.jsx)(g,{values:d,index:m,setIndex:y})]})},S=function(e){var n=e.source,t=e.onMouseMove,o=e.onMouseLeave,i=e.decorations,a=Object(r.useState)(y(n)),s=Object(c.a)(a,2),u=s[0],l=u.code,d=u.stepStream,j=d.steps,p=d.next,v=s[1],m=Object(r.useState)(0),x=Object(c.a)(m,2),w=x[0],k=x[1],M=Object(c.a)(j[w],3),S=M[0],L=M[1],N=M[2],D=l.map((function(e){var n=Object(c.a)(e,2);n[0];return n[1]})).join("\n"),E=L.join("\n"),C=N.join("\n"),R=j.some((function(e){var n=Object(c.a)(e,3);n[0],n[1];return n[2].length>0})),I=f(w,k,j.length);Object(r.useEffect)((function(){v(y(n)),k(0)}),[n]),Object(r.useEffect)((function(){w===j.length-1&&"HALT"!==D.split("\n")[S]&&v({code:l,stepStream:p()})}),[w,l,p,S,D,j.length]);return Object(h.jsxs)("div",{className:"interpreter",children:[Object(h.jsx)("div",{className:"interpreterTitle",children:Object(h.jsxs)("h3",{children:["Step ",w," - "]})}),Object(h.jsxs)("div",{className:"interpreterEditors",children:[Object(h.jsx)(b,{value:D,language:"javascript",onKeyDown:function(e){return I(e.key)},decorations:function(e,n){return[{range:new n.Range(S+1,1,S+1,1),options:{isWholeLine:!0,linesDecorationsClassName:"currentLineDec"}}].concat(Object(O.a)(i(l)(e,n)))},onMouseMove:t(l),onMouseLeave:o,options:{readOnly:!0,lineNumbers:function(e){return(e-1).toString()},theme:"vs-dark"}}),Object(h.jsx)(b,{value:E,language:"javascript",onKeyDown:function(e){return I(e.key)},options:{readOnly:!0,lineNumbers:function(e){return E.split("\n").length-e+1},minimap:{enabled:!1}}}),R?Object(h.jsx)(b,{value:C,language:"javascript",onKeyDown:function(e){return I(e.key)},options:{readOnly:!0,lineNumbers:function(e){return(e-1).toString()},theme:"vs-dark",minimap:{enabled:!1}}}):null]}),Object(h.jsx)(g,{values:j,index:w,setIndex:k})]})},L=t(46),N=t.n(L),D=t(33),E=t.n(D),C=t(47),R=t.n(C),I=t(48);E.a.use(R.a);function H(e){var n;switch(e){case"H_INT":n={shape:"square","background-color":"white"};break;case"H_BOOL":n={shape:"barrel","background-color":"purple"};break;case"H_CI":n={shape:"tag","background-color":"red"};break;case"H_HI":n={shape:"round-tag","background-color":"white"};break;case"H_HEADER":n={"background-color":"black"}}return n=Object(p.a)(Object(p.a)({},n),{},{"text-margin-y":"-10","text-justification":"left","text-wrap":"wrap",color:"green"})}var K,W=function(e){var n=e.source,t=e.onMouseMove,o=e.onMouseLeave,i=e.decorations,a=Object(r.useState)(w(n)),s=Object(c.a)(a,2),u=s[0],l=u.code,d=u.stepStream,j=d.steps,p=d.next,v=s[1],m=l.map((function(e){var n=Object(c.a)(e,2);n[0];return n[1]})).join("\n"),x=Object(r.useState)(0),y=Object(c.a)(x,2),k=y[0],M=y[1],S=j[k],L=S.stack,D=S.cp,E=S.fp,C=S.heap,R=S.heap_graph,K=L.slice().reverse().map((function(e){return e.slice(6)})).join("\n"),W=D+1,A=L.length-E,J=C.join("\n"),T=j.some((function(e){return e.heap.length>0})),_=f(k,M,j.length);Object(r.useEffect)((function(){v(w(n)),M(0)}),[n]),Object(r.useEffect)((function(){k===j.length-1&&"HALT"!==l[D][1].trim()&&v({code:l,stepStream:p()})}),[l,D,p,k,j.length]);var B=Object(r.useState)({heap:{show:!1,val:0},code:{showHeap:!1,heap:0}}),P=Object(c.a)(B,2),z=P[0],$=P[1],q=Object(c.a)(R,2),U=q[0],F=q[1],V=[].concat(Object(O.a)(U.map((function(e){return{data:e,style:H(e.tp[0])}}))),Object(O.a)(F.map((function(e){return{data:e}})))),X=Object(I.a)((function(e){var n=e.target._private.data,t="H_CI"===n.tp[0],r={heap:{val:parseInt(n.id)+1,show:!0},code:{showHeap:t,heap:t?n.pointer+1:z.code.heap}};$(r)}),50),Z=Object(I.a)((function(e){$({heap:{val:z.heap.val,show:!1},code:{showHeap:!1,heap:z.code.heap}})}),50);return Object(h.jsxs)("div",{className:"interpreter",children:[Object(h.jsx)("div",{className:"interpreterTitle",children:Object(h.jsxs)("h3",{children:["Step ",k," - "]})}),Object(h.jsxs)("div",{className:"interpreterEditors",children:[Object(h.jsx)(b,{value:m,width:"36%",language:"javascript",onKeyDown:function(e){return _(e.key)},decorations:function(e,n){return[{range:new n.Range(W,1,W,1),options:{isWholeLine:!0,linesDecorationsClassName:"currentLineDec"}},{range:new n.Range(z.code.heap,1,z.code.heap,1),options:{isWholeLine:!0,linesDecorationsClassName:z.code.showHeap?"heapPointerDec":""}}].concat(Object(O.a)(i(l)(e,n)))},onMouseMove:t(l),onMouseLeave:o,options:{readOnly:!0,lineNumbers:function(e){return(e-1).toString()},theme:"vs-dark",minimap:{enabled:!1},scrollBeyondLastLine:!1}}),Object(h.jsx)(b,{value:K,width:"20%",language:"javascript",onKeyDown:function(e){return _(e.key)},decorations:function(e,n){return[{range:new n.Range(A,1,A,1),options:{isWholeLine:!0,linesDecorationsClassName:"framePointerDec"}}]},options:{readOnly:!0,lineNumbers:function(e){return(K.split("\n").length-e+1).toString()},minimap:{enabled:!1},scrollBeyondLastLine:!1}}),Object(h.jsxs)("div",{className:"jargonMem",children:[T?Object(h.jsx)(b,{value:J,height:"50%",decorations:function(e,n){return z.heap.show&&e.revealRange(new n.Range(z.heap.val,1,z.heap.val,1)),[{range:new n.Range(z.heap.val,1,z.heap.val,1),options:{isWholeLine:!0,linesDecorationsClassName:z.heap.show?"heapPointerDec":""}}]},language:"javascript",onKeyDown:function(e){return _(e.key)},options:{readOnly:!0,lineNumbers:function(e){return(e-1).toString()},theme:"vs-dark",minimap:{enabled:!1},scrollBeyondLastLine:!1}}):null,Object(h.jsx)(N.a,{id:"heap",elements:V,style:{height:"50%"},cy:function(e){return e.on("add","node",(function(n){e.layout({name:"klay",klay:{direction:"DOWN",borderSpacing:80,spacing:80}}).run(),e.fit(),e.on("mouseover","node",X),e.on("mouseout","node",Z)}))}})]})]}),Object(h.jsx)(g,{values:j,index:k,setIndex:M})]})},A=function(e){var n,t=e.source,r=e.decorations,o=e.onMouseMove,i=e.onMouseLeave,a=(n=t,JSON.parse(slang.interp2Code(n))),c=k(a).slice(1,-1),s=function(e){return JSON.parse(slang.interp3Code(e))}(t),u=k(s),l=function(e){return JSON.parse(slang.jargonCode(e))}(t),d=k(l);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"editorWrapper",children:[Object(h.jsx)("h4",{children:"Interpreter 2"}),Object(h.jsx)(b,{defaultLanguage:"javascript",height:"86vh",value:c,onMouseMove:o(a),onMouseLeave:i,decorations:r(a),options:{tabSize:2,readOnly:!0,theme:"vs-dark",minimap:{enabled:!1}}})]}),Object(h.jsxs)("div",{className:"editorWrapper",children:[Object(h.jsx)("h4",{children:"Interpreter 3"}),Object(h.jsx)(b,{defaultLanguage:"javascript",value:u,onMouseMove:o(s),onMouseLeave:i,decorations:r(s),height:"86vh",options:{readOnly:!0,theme:"vs-dark",minimap:{enabled:!1}}})]}),Object(h.jsxs)("div",{className:"editorWrapper",children:[Object(h.jsx)("h4",{children:"Jargon"}),Object(h.jsx)(b,{defaultLanguage:"javascript",value:d,onMouseMove:o(l),onMouseLeave:i,decorations:r(l),height:"86vh",options:{readOnly:!0,theme:"vs-dark",minimap:{enabled:!1}}})]})]})},J=function(){return Object(h.jsxs)("div",{className:"landing",children:[Object(h.jsx)("h1",{children:"Slang Compiler Explorer"}),Object(h.jsx)("p",{children:"This online tool demonstrates the compilation stages taught in the Part II compilers course. It also demonstrates how the virtual machines for each of the stages execute their representations."}),Object(h.jsx)("p",{children:"Edit the source on the left to get started or choose an interpreter to visualize its execution execution. Choose the interpreter using the select on the bottom left."}),Object(h.jsx)("p",{children:"Use the arrow keys to navigate evaluation steps (as long as the editor on the left is not in focus)."}),Object(h.jsx)("p",{children:"Programs are encoded in the url so they can easily be shared."})]})},T=(t(83),j.fib),_=["All",A],B=["Interpreter 2",M],P=["Interpreter 3",S],z=["Jargon",W];!function(e){e.root="/",e.interp2="/interp2/",e.interp3="/interp3/",e.jargon="/jargon/"}(K||(K={}));var $={"/":function(){return[K.root,J,q(T)]},"/:code":function(e){var n=e.code;return[K.root,A,n]},"/interp2":function(){return[K.interp2,M,q(T)]},"/interp2/:code":function(e){var n=e.code;return[K.interp2,M,n]},"/interp3":function(){return[K.interp3,S,q(T)]},"/interp3/:code":function(e){var n=e.code;return[K.interp3,S,n]},"/jargon":function(){return[K.jargon,W,q(T)]},"/jargon/:code":function(e){var n=e.code;return[K.jargon,W,n]}};function q(e){return encodeURIComponent(e)}var U=function(){var e=Object(l.useRoutes)($),n=Object(c.a)(e,3),t=n[0],o=n[1],i=n[2],a=function(e){return decodeURIComponent(e)}(i),j=Object(r.useState)(a),p=Object(c.a)(j,2),v=p[0],f=p[1],g=Object(s.a)(v,1e3),m=Object(c.a)(g,1)[0];Object(r.useEffect)((function(){m!==a&&Object(l.navigate)(t+q(m))}),[m,t,a]);var x=Object(r.useState)({highlight:!1,line:0}),y=Object(c.a)(x,2),w=y[0],k=y[1],M=Object(s.a)(w,50),S=Object(c.a)(M,1)[0],L=Object(u.b)();Object(r.useEffect)((function(){null===L||void 0===L||L.editor.setTheme("vs-dark"),null===L||void 0===L||L.languages.register({id:"Slang"}),null===L||void 0===L||L.languages.setMonarchTokensProvider("Slang",d)}),[L]);var N=function(){return k({highlight:!1,line:0})};return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsxs)("div",{className:"editorWrapper",children:[Object(h.jsx)("h4",{children:"Source"}),Object(h.jsx)(b,{height:"86vh",defaultValue:m,defaultLanguage:"Slang",onMouseMove:function(e){var n,t,r=null===e||void 0===e||null===(n=e.target)||void 0===n||null===(t=n.position)||void 0===t?void 0:t.lineNumber;null!==r&&void 0!==r&&k({line:r,highlight:!0})},onMouseLeave:N,decorations:function(e,n){return S.highlight?[{range:new n.Range(S.line,1,S.line,1),options:{isWholeLine:!0,linesDecorationsClassName:"sourceLineDec"}}]:[]},onChange:function(e,n){return f(void 0===e?"":e)},options:{theme:"vs-dark",minimap:{enabled:!1},scrollBeyondLastLine:!1}}),Object(h.jsx)("div",{className:"selectBox",children:Object(h.jsxs)("select",{value:t,onChange:function(e){return Object(l.navigate)(e.target.value+i)},children:[Object(h.jsx)("option",{value:K.root,children:_[0]}),Object(h.jsx)("option",{value:K.interp2,children:B[0]}),Object(h.jsx)("option",{value:K.interp3,children:P[0]}),Object(h.jsx)("option",{value:K.jargon,children:z[0]})]})})]}),Object(h.jsx)(o,{source:m,onMouseMove:function(e){return function(n){var t,r,o=null===n||void 0===n||null===(t=n.target)||void 0===t||null===(r=t.position)||void 0===r?void 0:r.lineNumber;null!==o&&void 0!==o&&k({line:e[o-1][0],highlight:!0})}},onMouseLeave:N,decorations:function(e){return function(n,t){return S.highlight?(r=e,o=S.line,r.reduce((function(e,n,t){return n[0]===o?[t].concat(Object(O.a)(e)):e}),[])).map((function(e){return{range:new t.Range(e+1,1,e+1,1),options:{isWholeLine:!0,linesDecorationsClassName:"sourceLineDec"}}})):[];var r,o}}})]})};a.a.render(Object(h.jsx)(o.a.StrictMode,{children:Object(h.jsx)(U,{})}),document.getElementById("root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.13f9c5a9.chunk.js.map